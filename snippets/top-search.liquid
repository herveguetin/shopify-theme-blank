<div x-data="topSearch">
  <div class="text-white cursor-pointer" @click="open()">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1"
      stroke="currentColor"
      class="w-6 h-6"
    >
      <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
    </svg>
  </div>
  <template x-teleport="body">
    <aside
      class="_aside bg-stone-300"
      :class="isOpen ? 'transform-none' : 'translate-x-full'"
    >
      <div class="h-full overflow-hidden">
        <div @click="isOpen = false" class="flex justify-end">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            class="w-10 h-10 cursor-pointer"
          >
            <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <div class="mt-10 h-full">
          <input
            type="text"
            class="w-full p-2 bg-transparent border border-stone-700 placeholder-stone-700"
            placeholder="Votre recherche..."
            x-model="q"
            x-on:input.change.debounce="query()"
          >
          <div x-show="products.length === 0 && canShowNoResults">No result found</div>
          <div x-show="products.length > 0" class="overflow-y-scroll h-full pb-40">
            <ul class="mt-2">
              <template x-for="product in products">
                <li>
                  <a :href="product.url">
                    <div class="w-full flex bg-white py-4 mb-2">
                      <div class="ml-0 w-1/4 min-h-full self-center">
                        <img :src="product.image" class="" :alt="product.title">
                      </div>
                      <div class="w-full pl-2">
                        <div x-text="product.title" class="font-bodoni"></div>
                        <div x-text="product.type"></div>
                      </div>
                      <div class="ml-auto mr-0 w-16 text-right self-center font-bodoni text-xl text-right">
                        <span x-text="window.formatPrice(product.price)"></span>
                      </div>
                    </div>
                  </a>
                </li>
              </template>
            </ul>
          </div>
        </div>
      </div>
    </aside>
  </template>
</div>
